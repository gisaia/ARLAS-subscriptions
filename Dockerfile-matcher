FROM openjdk:8-jre-alpine

# install script dependencies
RUN apk add --update bash netcat-openbsd curl && rm -rf /var/cache/apk/*

# application placed into /opt/app
WORKDIR /opt/app
ADD subscriptions-matcher/target/subscriptions-matcher*.jar /opt/app/subscriptions-matcher.jar
ADD conf/configuration-matcher.yaml /opt/app/configuration-matcher.yaml
ADD subscriptions-matcher/scripts/wait-for-deps.sh /opt/app/wait-for-deps.sh

ENTRYPOINT ["bash", "-c"]
CMD ["java -jar /opt/app/subscriptions-matcher.jar server /opt/app/configuration-matcher.yaml"]
